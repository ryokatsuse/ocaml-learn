## 例外と例外処理

### オプション型

```
(* `a型の値があるか値がないのかのどちらかの型 *)
type `a option = None
  | SOme of `a

```

- Noneは型がないことを示す構成子。Someは`a型の値が存在することを示す構成子。
  - これを組み合わせると「普通は`a型であるが、値がなくても構わない」ということを示す

- 以下野菜の値段を調べる関数
  - 野菜が見つからなかった時にNoneとしてみつかったときはSome（p）としてpの引数に値段を入れることで区別するようにできる
  - 考え方として0を返すという解釈ができる、理由として見つからなかった時はお金を払わないので金額とて0円になる
  - しかし無料だった場合と区別がつくことができないので実際に野菜を手に入れたかどうかが分からない
  - 特定の数字を特殊な意味で意味合いをもたせるのはプログラムを複雑にするので避けるべき

```

let rec price item yaoya_list = match yaoya_list with
  [] -> None
  | (yasai, nedan) :: rest ->
    if item = yasai then Some(nedan)
    else price item rest

```

### オプション型を使った例外処理の問題点

- 例外的な処理を実装する場合にプログラムの構造が複雑になってしまうことがある
- これは本来好ましいことではないので例外的な場合は、あくまで例外として例外的に記述するべきで本来の計算の記述が乱されてしまってはプログラムの見通しが悪くなってしまう

### 例外処理の構文

- 上記のようにプログラムの見通しを悪くしてしまうので専用の構文が用意されている（JavaScriptで言うところのtry catch..）

```
raise 例外の名前
```

- 上記が呼ばれた時点でプログラムの実行を一時中止する

```
try 式 with
```

- tryとwithに挟まれた式を実行する
- その式で例外が発生しなければwithの後の式はどれも実行されないようになっている
- 例外処理は一見まずいことが起きた時の対処法に見えるが実際のプログラミングでは例外処理を使って処理をジャンプするように使うことがある